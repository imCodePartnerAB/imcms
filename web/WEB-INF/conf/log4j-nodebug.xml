<?xml version="1.0" encoding="UTF-8"?>

<!-- Start log4j2 configuration -->
<Configuration>
	<Appenders>

		<!-- The accesslog (logs usermovements) -->
		<RollingFile name="ACCESS"
		             fileName="${WEB_APP_PATH}/WEB-INF/logs/access.log"
		             filePattern="${WEB_APP_PATH}/WEB-INF/logs/access-%d{yyyy-MM}.log"
		             ignoreExceptions="false">
			<PatternLayout>
				<Pattern>%d{ISO8601} %m%n</Pattern>
			</PatternLayout>
			<Policies>
				<TimeBasedTriggeringPolicy interval="1" modulate="true"/>
			</Policies>
		</RollingFile>

		<!-- The mainlog (captures edits and changes) -->
		<RollingFile name="MAIN"
		             fileName="${WEB_APP_PATH}/WEB-INF/logs/main.log"
		             filePattern="${WEB_APP_PATH}/WEB-INF/logs/main-%d{yyyy-MM}.log"
		             ignoreExceptions="false">
			<PatternLayout>
				<Pattern>%d{ISO8601} %-5p %m%n</Pattern>
			</PatternLayout>
			<Policies>
				<TimeBasedTriggeringPolicy interval="1" modulate="true"/>
			</Policies>
		</RollingFile>

		<!-- The errorlog (captures everything that doesn't go to one of the above. -->
		<RollingFile name="ERROR"
		             fileName="${WEB_APP_PATH}/WEB-INF/logs/error.log"
		             filePattern="${WEB_APP_PATH}/WEB-INF/logs/error-%d{yyyy-MM}.log"
		             ignoreExceptions="false">
			<PatternLayout>
				<Pattern>%d{ISO8601} %-5p %c - %m%n</Pattern>
			</PatternLayout>
			<Policies>
				<TimeBasedTriggeringPolicy interval="1" modulate="true"/>
			</Policies>
		</RollingFile>
	</Appenders>
	<Loggers>
		<!-- Set up accesslog with priority 'info' -->
		<Logger name="com.imcode.imcms.log.access" level="info" additivity="false">
			<AppenderRef ref="ACCESS"/>
		</Logger>

		<!-- Set up mainlog with priority 'info' -->
		<Logger name="com.imcode.imcms.log.main" level="info" additivity="false">
			<AppenderRef ref="MAIN"/>
		</Logger>

		<Logger name="org.apache" level="error" additivity="false">
			<AppenderRef ref="ERROR"/>
		</Logger>

		<!-- Set up the errorlog with priority 'info' -->
		<Root level="info">
			<AppenderRef ref="ERROR"/>
		</Root>

	</Loggers>
</Configuration>