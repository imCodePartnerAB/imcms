<?xml version="1.0" encoding="UTF-8"?>

<!-- Start log4j2 configuration -->
<Configuration status="debug">
	<Appenders>
		<!-- The accesslog (logs usermovements) -->
		<RollingFile name="ACCESS"
		             fileName="${WEB_APP_PATH}/WEB-INF/logs/access.log"
		             filePattern="${WEB_APP_PATH}/WEB-INF/logs/access-%d{yyyy-MM}-%i.log.gz"
		             ignoreExceptions="false">
			<PatternLayout charset="UTF-8" pattern="%d{ISO8601} %m%n"/>
			<Policies>
				<TimeBasedTriggeringPolicy interval="1" modulate="true"/>
			</Policies>
		</RollingFile>

		<!-- The mainlog (captures edits and changes) -->
		<RollingFile name="MAIN"
		             fileName="${WEB_APP_PATH}/WEB-INF/logs/main.log"
		             filePattern="${WEB_APP_PATH}/WEB-INF/logs/main-%d{yyyy-MM}-%i.log.gz"
		             ignoreExceptions="false">
			<PatternLayout charset="UTF-8" pattern="%d{ISO8601} %-5p %m%n"/>
			<Policies>
				<TimeBasedTriggeringPolicy interval="1" modulate="true"/>
			</Policies>
		</RollingFile>

		<!-- The errorlog (captures everything that doesn't go to one of the above. -->
		<RollingFile name="ERROR"
		             fileName="${WEB_APP_PATH}/WEB-INF/logs/error.log"
		             filePattern="${WEB_APP_PATH}/WEB-INF/logs/error-%d{yyyy-MM}-%i.log.gz"
		             ignoreExceptions="false">
			<PatternLayout charset="UTF-8" pattern="%d{ISO8601} %-5p %c %x - %m%n"/>
			<Policies>
				<TimeBasedTriggeringPolicy interval="1" modulate="true"/>
			</Policies>
		</RollingFile>

		<Console name="STDOUT" target="SYSTEM_OUT">
			<PatternLayout pattern="%d{ISO8601} %-5p %c %x - %m%n" charset="UTF-8"/>
		</Console>
	</Appenders>
	<Loggers>
		<!-- Set up accesslog with priority 'debug' -->
		<Logger name="com.imcode.imcms.log.access" level="debug" additivity="false">
			<AppenderRef ref="ACCESS"/>
		</Logger>

		<!-- Set up mainlog with priority 'debug' -->
		<Logger name="com.imcode.imcms.log.main" level="debug" additivity="false">
			<AppenderRef ref="MAIN"/>
		</Logger>

		<Logger name="org.apache" level="error" additivity="false">
			<AppenderRef ref="ERROR"/>
		</Logger>

		<!-- Set up the errorlog with priority 'debug' -->
		<Root level="trace">
			<AppenderRef ref="ERROR"/>
			<AppenderRef ref="STDOUT"/>
		</Root>
	</Loggers>
</Configuration>